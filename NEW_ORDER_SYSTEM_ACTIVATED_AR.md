# โ ุชู ุชูุนูู ูุธุงู ุงูุทูุจุงุช ุงูุฌุฏูุฏ!

## ูุง ุชู ุชูุนููู ุงูุขู:

### 1. ุงุณุชุจุฏุงู ุงููุธุงู ุงููุฏูู ุจุงูุฌุฏูุฏ โ
```typescript
// ุงููุฏูู
import orderRoutes from './routes/orders'

// ุงูุฌุฏูุฏ โ
import orderRoutes from './routes/ordersNew'
```

### 2. ุฅุถุงูุฉ ูุนุงูุฌุฉ Callbacks & Webhooks โ
```typescript
import paymentCallbackRoutes from './routes/paymentCallbacks'
app.use('/api/payment', paymentCallbackRoutes)
```

---

## ุงููุฑู ุจูู ุงููุธุงู ุงููุฏูู ูุงูุฌุฏูุฏ:

### ุงููุธุงู ุงููุฏูู โ
```
1. ุฅูุดุงุก ุงูุทูุจ
2. ูุญุงููุฉ ุงูุฏูุน
3. ุงูุทูุจ ูุจูู ุญุชู ูู ูุดู ุงูุฏูุน โ
4. ูุธูุฑ ูู ููุญุฉ ุงูุชุญูู โ
5. ุงูุนููู ูุฑุงู ูู ุทูุจุงุชู โ
```

### ุงููุธุงู ุงูุฌุฏูุฏ โ
```
1. ุงูุชุญูู ูู ูู ุดูุก ุฃููุงู:
   โ ุงููุฎุฒูู ูุชููุฑุ
   โ ุงูุนููุงู ุตุญูุญุ
   โ ุฑูู ุงูุฌูุงู ุตุญูุญุ
   โ ุทุฑููุฉ ุงูุฏูุน ููุนูุฉุ

2. ุฅูุดุงุก ุงูุทูุจ:
   - COD โ ูุคูุฏ ูุจุงุดุฑุฉ โ
   - ุฅููุชุฑููู โ ูุนูู (pending)

3. ูุญุงููุฉ ุงูุฏูุน:
   - ูุฌุญ โ ุชุฃููุฏ ุงูุทูุจ โ
   - ูุดู โ ุฅูุบุงุก ุงูุทูุจ ุชููุงุฆูุงู โ

4. ุงููุชูุฌุฉ:
   - ููุท ุงูุทูุจุงุช ุงููุคูุฏุฉ ุชุธูุฑ โ
   - ูุง ุทูุจุงุช ูุงุดูุฉ โ
```

---

## ููููุฉ ุงูุงุฎุชุจุงุฑ ุงูุขู:

### ุงูุฎุทูุฉ 1: ุฃุนุฏ ุชุดุบูู Backend
```bash
# ุฃููู Backend (Ctrl+C)
# ุซู ุดุบูู ูุฑุฉ ุฃุฎุฑู
cd backend
npm run dev
```

ูุฌุจ ุฃู ุชุดูู:
```
โ Mobile Store Server running on:
   - Local:   http://localhost:5000
   - Network: http://0.0.0.0:5000
```

### ุงูุฎุทูุฉ 2: ูุนูู ุทุฑู ุงูุฏูุน
```bash
cd backend
npx ts-node enable-test-payment.ts
```

### ุงูุฎุทูุฉ 3: ุฌุฑุจ ุฅูุดุงุก ุทูุจ

#### ุฃ. ุทูุจ COD (ูุนูู ูุจุงุดุฑุฉ):
```bash
curl -X POST http://localhost:5000/api/orders \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "items": [
      {
        "productId": "PRODUCT_ID",
        "quantity": 1,
        "price": 1799
      }
    ],
    "shippingAddress": {
      "fullName": "ุฃุญูุฏ ูุญูุฏ",
      "phone": "0501234567",
      "city": "ุงูุฑูุงุถ",
      "district": "ุงููุฑุฌุณ",
      "street": "ุดุงุฑุน ุงูุชุญููุฉ"
    },
    "paymentMethod": "cod"
  }'
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "success": true,
  "order": {
    "id": "...",
    "orderNumber": "#10001",
    "total": 1799,
    "status": "confirmed",
    "paymentMethod": "cod"
  },
  "message": "ุชู ุฅูุดุงุก ุงูุทูุจ ุจูุฌุงุญ"
}
```

#### ุจ. ุทูุจ ุจุฏูุน ุฅููุชุฑููู:
```bash
# ููุณ ุงูุทูุจ ููู
"paymentMethod": "tap"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "success": true,
  "order": {
    "id": "...",
    "orderNumber": "#10002",
    "total": 1799,
    "status": "pending",
    "paymentMethod": "tap"
  },
  "payment": {
    "paymentUrl": "https://tap.company/...",
    "transactionId": "..."
  },
  "message": "ุชู ุฅูุดุงุก ุงูุทูุจ ุจูุฌุงุญ"
}
```

---

## ุงูุชุญููุงุช ุงูุฌุฏูุฏุฉ:

### 1. ุงูุชุญูู ูู ุฑูู ุงูุฌูุงู โ
```
ููุจู:
โ 0501234567
โ 501234567
โ +966501234567
โ 966501234567

ูุฑูุถ:
โ 123456 (ูุตูุฑ)
โ abc123 (ุญุฑูู)
โ 0401234567 (ูุง ูุจุฏุฃ ุจู 05)
```

### 2. ุงูุชุญูู ูู ุงูุนููุงู โ
```
ูุทููุจ:
โ ุงูุงุณู ุงููุงูู (3 ุฃุญุฑู ุนูู ุงูุฃูู)
โ ุฑูู ุงูุฌูุงู (ุตุญูุญ)
โ ุงููุฏููุฉ
โ ุงูุญู
โ ุงูุดุงุฑุน

ุงุฎุชูุงุฑู:
- ุฑูู ุงููุจูู
- ููุงุญุธุงุช ุฅุถุงููุฉ
```

### 3. ุงูุชุญูู ูู ุงููุฎุฒูู โ
```
ุฅุฐุง ุงูููุชุฌ:
- ุบูุฑ ููุฌูุฏ โ ุฎุทุฃ
- ุงููุฎุฒูู ุฃูู ูู ุงููุทููุจ โ ุฎุทุฃ
- ุงููุฎุฒูู ูุงูู โ โ
```

### 4. ุญุณุงุจ ุงูุดุญู โ
```
ุงูุฑูุงุถ: ูุฌุงูู
ุฌุฏุฉ: 25 ุฑ.ุณ
ุงูุฏูุงู: 30 ุฑ.ุณ
ููุฉ: 25 ุฑ.ุณ
ุงููุฏููุฉ: 30 ุฑ.ุณ
ุจุงูู ุงููุฏู: 30-50 ุฑ.ุณ
```

### 5. ุญุณุงุจ ุงูุถุฑูุจุฉ โ
```
15% ูู ุงููุฌููุน ุงููุฑุนู
```

---

## ุฑุณุงุฆู ุงูุฃุฎุทุงุก ุงูุฌุฏูุฏุฉ:

### ุฃุฎุทุงุก ุงูุชุญูู:
```json
{
  "success": false,
  "message": "ุฑูู ุงูุฌูุงู ุบูุฑ ุตุญูุญ",
  "field": "phone"
}
```

### ุฃุฎุทุงุก ุงููุฎุฒูู:
```json
{
  "success": false,
  "message": "ุงูููุชุฌ 'ุฃุจุนุงุฏ X ุจุฑู' ุบูุฑ ูุชููุฑ ุจุงููููุฉ ุงููุทููุจุฉ. ุงููุชููุฑ: 5",
  "productId": "..."
}
```

### ุฃุฎุทุงุก ุงูุฏูุน:
```json
{
  "success": false,
  "message": "ุทุฑููุฉ ุงูุฏูุน ุบูุฑ ูุชุงุญุฉ",
  "code": "PAYMENT_METHOD_DISABLED"
}
```

---

## ุงูุทูุจุงุช ุงูุขู:

### ููุนููู:
```
GET /api/orders/my-orders
```
- โ ูุฑู ููุท ุงูุทูุจุงุช ุงููุคูุฏุฉ
- โ ูุง ูุฑู ุงูุทูุจุงุช ุงููุนููุฉ (pending)
- โ ูุง ูุฑู ุงูุทูุจุงุช ุงูููุบุงุฉ

### ููุฃุฏูู:
```
GET /api/orders/admin/all
```
- โ ูุฑู ุฌููุน ุงูุทูุจุงุช
- โ ูุฑู ุงูุทูุจุงุช ุงููุนููุฉ (ูููุฑุงูุจุฉ)
- โ ูุฑู ุงูุทูุจุงุช ุงูููุบุงุฉ

---

## Endpoints ุงูุฌุฏูุฏุฉ:

### ููุนููุงุก:
```
POST   /api/orders              - ุฅูุดุงุก ุทูุจ
GET    /api/orders/my-orders    - ุทูุจุงุชู
GET    /api/orders/:id          - ุชูุงุตูู ุทูุจ
POST   /api/orders/:id/cancel   - ุฅูุบุงุก ุทูุจ
```

### ููุฃุฏูู:
```
GET    /api/orders/admin/all         - ุฌููุน ุงูุทูุจุงุช
PATCH  /api/orders/:id/status        - ุชุญุฏูุซ ุงูุญุงูุฉ
```

### Callbacks & Webhooks:
```
GET    /api/payment/callback          - ูู ุงูุจูุงุจุฉ ููุนููู
POST   /api/payment/webhook/tap       - ูู Tap ููุณูุฑูุฑ
POST   /api/payment/webhook/tabby     - ูู Tabby ููุณูุฑูุฑ
POST   /api/payment/webhook/tamara    - ูู Tamara ููุณูุฑูุฑ
POST   /api/payment/webhook/myfatoorah - ูู MyFatoorah ููุณูุฑูุฑ
```

---

## ุงูุฎูุงุตุฉ:

โ **ุงููุธุงู ุงูุฌุฏูุฏ ููุนู ุงูุขู!**

- ุงูุชุญููุงุช ุชุนูู
- ุงูุญุณุงุจุงุช ุตุญูุญุฉ
- ุงูุทูุจุงุช ุงููุงุดูุฉ ุชููุบู ุชููุงุฆูุงู
- ููุท ุงูุทูุจุงุช ุงููุคูุฏุฉ ุชุธูุฑ

**ุฌุฑุจ ุงูุขู ูุดูู ุงููุฑู! ๐**

---

## ุฅุฐุง ูุงุฌูุช ูุดุงูู:

### 1. Backend ูุง ูุดุชุบู:
```bash
cd backend
npm install
npm run dev
```

### 2. ุงูุทูุจุงุช ูุง ุชุฒุงู ุชููุดุฃ ุจุฏูู ุชุญูู:
```bash
# ุชุฃูุฏ ุฃู Backend ุฃุนูุฏ ุชุดุบููู
# ุงุถุบุท Ctrl+C ุซู npm run dev
```

### 3. ุทุฑู ุงูุฏูุน ูุง ุชุนูู:
```bash
cd backend
npx ts-node enable-test-payment.ts
```

### 4. ุฃุฎุทุงุก TypeScript:
```bash
cd backend
npm run build
```

**ุงูุขู ุงููุธุงู ุงุญุชุฑุงูู ูุฌุงูุฒ! โ**
