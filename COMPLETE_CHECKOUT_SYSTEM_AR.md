# ๐ ูุธุงู ุงูุทูุจุงุช ุงููุชูุงูู - ุฏููู ุดุงูู

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุจูุงุก ูุธุงู ุทูุจุงุช ุงุญุชุฑุงูู ูุชูุงูู ูุน:
- โ ูุนูููุงุช ุงูุดุญู (ุงูุนููุงู)
- โ ุงุฎุชูุงุฑ ุดุฑูุฉ ุงูุดุญู (ุณูุณุงุ ุฑูุฏุจูุณุ ุฃุฑุงููุณ)
- โ ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน
- โ ุญุณุงุจ ุชููุงุฆู ููุถุฑูุจุฉ ูุงูุดุญู

---

## ๐ ุชุฏูู ุงูุทูุจ (Order Flow)

### 1๏ธโฃ ูุนูููุงุช ุงูุดุญู
ุงูุนููู ูุฏุฎู:
- ุงูุงุณู ุงููุงูู
- ุฑูู ุงูุฌูุงู
- ุงููุฏููุฉ โญ
- ุงูุญู
- ุงูุดุงุฑุน
- ุฑูู ุงููุจูู (ุงุฎุชูุงุฑู)
- ููุงุญุธุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)

### 2๏ธโฃ ุงุฎุชูุงุฑ ุดุฑูุฉ ุงูุดุญู
ุจูุงุกู ุนูู **ุงููุฏููุฉ ุงููุฎุชุงุฑุฉ**:
- ูุชู ุฌูุจ ุดุฑูุงุช ุงูุดุญู ุงููุชุงุญุฉ
- ุนุฑุถ ุงูุณุนุฑ ูุงููุฏุฉ ุงููุชููุนุฉ ููู ุดุฑูุฉ
- ุงูุนููู ูุฎุชุงุฑ ุงูุดุฑูุฉ ุงูููุงุณุจุฉ

### 3๏ธโฃ ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน
- ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู (COD)
- ุชุงุจ (Tap)
- ูุงู ูุงุชูุฑุฉ (MyFatoorah)
- ุชูุงุฑุง (Tamara)
- ุชุงุจู (Tabby)

### 4๏ธโฃ ุงูุญุณุงุจ ุงูุชููุงุฆู
```
ุงููุฌููุน ุงููุฑุนู = ุณุนุฑ ุงูููุชุฌุงุช
ุงูุดุญู = ุญุณุจ ุงูุดุฑูุฉ ูุงููุฏููุฉ ุงููุฎุชุงุฑุฉ
ุงูุถุฑูุจุฉ = ุงููุฌููุน ุงููุฑุนู ร ูุณุจุฉ ุงูุถุฑูุจุฉ (ูู ุงูุฅุนุฏุงุฏุงุช)
ุงูุฅุฌูุงูู = ุงููุฌููุน ุงููุฑุนู + ุงูุดุญู + ุงูุถุฑูุจุฉ
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

### ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ
**ุงููููุน:** `http://localhost:3000/admin/settings/general`

- **ุชูุนูู/ุชุนุทูู ุงูุถุฑูุจุฉ**
- **ูุณุจุฉ ุงูุถุฑูุจุฉ** (ุงูุชุฑุงุถู: 15%)
- ูุชู ุญุณุงุจูุง ุชููุงุฆูุงู ุนูู ุงููุฌููุน ุงููุฑุนู

### ุฅุนุฏุงุฏุงุช ุงูุดุญู
**ุงููููุน:** `http://localhost:3000/admin/settings/shipping`

#### ุดุฑูุงุช ุงูุดุญู:
- **ุณูุณุง (SMSA)**
- **ุฑูุฏุจูุณ (Redbox)**
- **ุฃุฑุงููุณ (Aramex)**

#### ููู ุดุฑูุฉ:
- ุชูุนูู/ุชุนุทูู
- ูุถุน ุชุฌุฑูุจู/ุญูููู
- ููุงุชูุญ API
- ุฃุณุนุงุฑ ูุฎุตุตุฉ ููู ูุฏููุฉ

### ุฅุนุฏุงุฏุงุช ุงูุดุญู ุงููุฌุงูู
**ุงููููุน:** `http://localhost:3000/admin/settings/general`

- **ุงูุญุฏ ุงูุฃุฏูู ููุดุญู ุงููุฌุงูู** (ุงูุชุฑุงุถู: 500 ุฑูุงู)
- ุนูุฏ ุชุฌุงูุฒ ูุฐุง ุงููุจูุบุ ุงูุดุญู ูุตุจุญ ูุฌุงูู

---

## ๐ ุงูุชูุนูู

### 1๏ธโฃ ุชุดุบูู ุงูุณูุฑูุจุช ุงูุชููุงุฆู
```bash
ACTIVATE_SHIPPING.bat
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
- ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชููุฆุฉ ุดุฑูุงุช ุงูุดุญู
- ุชููุฆุฉ ุฃุณุนุงุฑ ุงูุดุญู ูู 10 ูุฏู
- ุชููุฆุฉ ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ (15%)
- ุชููุฆุฉ ุงูุดุญู ุงููุฌุงูู (500 ุฑูุงู)

### 2๏ธโฃ ุชุดุบูู ุงูุณูุฑูุฑ
```bash
cd backend
npm run dev
```

### 3๏ธโฃ ูุชุญ ููุญุฉ ุงูุฅุฏุงุฑุฉ
```
http://localhost:3000/admin/settings/general
http://localhost:3000/admin/settings/shipping
```

---

## ๐ฐ ุฃุณุนุงุฑ ุงูุดุญู ุงูุงูุชุฑุงุถูุฉ

| ุงููุฏููุฉ | ุณูุณุง | ุฑูุฏุจูุณ | ุฃุฑุงููุณ |
|---------|------|--------|--------|
| ุงูุฑูุงุถ | 15 ุฑูุงู | 18 ุฑูุงู | 20 ุฑูุงู |
| ุฌุฏุฉ | 20 ุฑูุงู | 15 ุฑูุงู | 25 ุฑูุงู |
| ุงูุฏูุงู | 20 ุฑูุงู | 22 ุฑูุงู | 18 ุฑูุงู |
| ููุฉ | 20 ุฑูุงู | 15 ุฑูุงู | 25 ุฑูุงู |
| ุงููุฏููุฉ | 25 ุฑูุงู | 20 ุฑูุงู | 28 ุฑูุงู |
| ุงูุฎุจุฑ | 20 ุฑูุงู | 22 ุฑูุงู | 18 ุฑูุงู |
| ุงูุทุงุฆู | 22 ุฑูุงู | 18 ุฑูุงู | 26 ุฑูุงู |
| ุชุจูู | 30 ุฑูุงู | 28 ุฑูุงู | 32 ุฑูุงู |
| ุฃุจูุง | 28 ุฑูุงู | 26 ุฑูุงู | 30 ุฑูุงู |
| ุญุงุฆู | 28 ุฑูุงู | 26 ุฑูุงู | 30 ุฑูุงู |

---

## ๐งฎ ุฃูุซูุฉ ุงูุญุณุงุจ

### ูุซุงู 1: ุทูุจ ุนุงุฏู
```
ุงูููุชุฌุงุช: 1,000 ุฑูุงู
ุงูุดุญู (ุณูุณุง - ุงูุฑูุงุถ): 15 ุฑูุงู
ุงูุถุฑูุจุฉ (15%): 150 ุฑูุงู
โโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู: 1,165 ุฑูุงู
```

### ูุซุงู 2: ุทูุจ ูุน ุดุญู ูุฌุงูู
```
ุงูููุชุฌุงุช: 600 ุฑูุงู (ุฃูุซุฑ ูู 500)
ุงูุดุญู: 0 ุฑูุงู (ูุฌุงูู)
ุงูุถุฑูุจุฉ (15%): 90 ุฑูุงู
โโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู: 690 ุฑูุงู
```

### ูุซุงู 3: ุจุฏูู ุถุฑูุจุฉ
```
ุงูููุชุฌุงุช: 1,000 ุฑูุงู
ุงูุดุญู (ุฑูุฏุจูุณ - ุฌุฏุฉ): 15 ุฑูุงู
ุงูุถุฑูุจุฉ: 0 ุฑูุงู (ูุนุทูุฉ)
โโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูุฅุฌูุงูู: 1,015 ุฑูุงู
```

---

## ๐ง API Endpoints

### ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ
```javascript
// ุฌูุจ ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ (Public)
GET /api/settings/tax

Response:
{
  "success": true,
  "tax": {
    "rate": 0.15,
    "enabled": true
  }
}

// ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ (Admin)
PUT /api/settings/tax
Authorization: Bearer {admin_token}

Body:
{
  "rate": 0.15,
  "enabled": true
}
```

### ุฅุนุฏุงุฏุงุช ุงูุดุญู
```javascript
// ุฌูุจ ุฃุณุนุงุฑ ุงูุดุญู ุญุณุจ ุงููุฏููุฉ (Public)
GET /api/shipping/rates?city=ุงูุฑูุงุถ

Response:
{
  "success": true,
  "rates": [
    {
      "providerId": "xxx",
      "providerName": "ุณูุณุง",
      "price": 15,
      "estimatedDays": 1
    }
  ]
}
```

### ุฅูุดุงุก ุทูุจ
```javascript
POST /api/orders
Authorization: Bearer {user_token}

Body:
{
  "items": [
    {
      "productId": "xxx",
      "quantity": 1,
      "price": 1000
    }
  ],
  "shippingAddress": {
    "fullName": "ุฃุญูุฏ ูุญูุฏ",
    "phone": "0501234567",
    "city": "ุงูุฑูุงุถ",
    "district": "ุงููุฑุฌุณ",
    "street": "ุดุงุฑุน ุงูุชุญููุฉ",
    "buildingNumber": "1234",
    "additionalInfo": ""
  },
  "paymentMethod": "cod",
  "shippingProviderId": "provider_id",
  "shippingCost": 15,
  "taxRate": 0.15
}

Response:
{
  "success": true,
  "order": {
    "id": "order_id",
    "total": 1165,
    "status": "PENDING"
  }
}
```

---

## ๐ฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุตูุญุฉ ุงูุทูุจ (Checkout)
**ุงููููุน:** `frontend/src/app/checkout/page-new.tsx`

#### ุงููููุฒุงุช:
- โ ุฎุทูุงุช ูุงุถุญุฉ (ูุนูููุงุช ุงูุดุญู โ ุงูุฏูุน)
- โ ุงุฎุชูุงุฑ ุดุฑูุฉ ุงูุดุญู ุชููุงุฆูุงู ุญุณุจ ุงููุฏููุฉ
- โ ุนุฑุถ ุงูุฃุณุนุงุฑ ูุงููุฏุฉ ุงููุชููุนุฉ
- โ ุญุณุงุจ ุชููุงุฆู ููุฅุฌูุงูู
- โ ููุฎุต ุงูุทูุจ ูุจุงุดุฑ
- โ ุชุญูู ูู ุงูุจูุงูุงุช

### ููุญุฉ ุงูุฅุฏุงุฑุฉ

#### ุฅุนุฏุงุฏุงุช ุนุงูุฉ
**ุงููููุน:** `frontend/src/app/admin/settings/general/page.tsx`
- ุฅุนุฏุงุฏุงุช ุงูุถุฑูุจุฉ
- ุฅุนุฏุงุฏุงุช ุงูุดุญู ุงููุฌุงูู

#### ุฅุนุฏุงุฏุงุช ุงูุดุญู
**ุงููููุน:** `frontend/src/app/admin/settings/shipping/page.tsx`
- ุฅุฏุงุฑุฉ ุดุฑูุงุช ุงูุดุญู
- ุชูุนูู/ุชุนุทูู ุงูุดุฑูุงุช
- ุฅุฏุฎุงู ููุงุชูุญ API
- ุงูุชุจุฏูู ุจูู ุงููุถุน ุงูุชุฌุฑูุจู ูุงูุญูููู

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุงูู
```bash
cd backend
npm run test:shipping
```

### 2. ุงุฎุชุจุงุฑ ูู ุงููุชุตูุญ

#### ุฎุทูุฉ 1: ุฅุนุฏุงุฏ ุงูุฅุนุฏุงุฏุงุช
1. ุงูุชุญ: `http://localhost:3000/admin/settings/general`
2. ุชุฃูุฏ ูู ุชูุนูู ุงูุถุฑูุจุฉ (15%)
3. ุญุฏุฏ ุงูุญุฏ ุงูุฃุฏูู ููุดุญู ุงููุฌุงูู (500 ุฑูุงู)

#### ุฎุทูุฉ 2: ุฅุนุฏุงุฏ ุงูุดุญู
1. ุงูุชุญ: `http://localhost:3000/admin/settings/shipping`
2. ูุนูู ุดุฑูุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู
3. ุชุฃูุฏ ูู ูุฌูุฏ ุฃุณุนุงุฑ ูููุฏู

#### ุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูุทูุจ
1. ุงูุชุญ: `http://localhost:3000`
2. ุฃุถู ููุชุฌ ููุณูุฉ
3. ุงุฐูุจ ููุทูุจ: `http://localhost:3000/checkout`
4. ุฃุฏุฎู ูุนูููุงุช ุงูุดุญู
5. ุงุฎุชุฑ ุงููุฏููุฉ โ ุณุชุธูุฑ ุดุฑูุงุช ุงูุดุญู
6. ุงุฎุชุฑ ุดุฑูุฉ ุงูุดุญู
7. ุงุถุบุท "ุงูุชุงูู"
8. ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน
9. ุชุญูู ูู ุงูุญุณุงุจ ูู ููุฎุต ุงูุทูุจ
10. ุฃููู ุงูุทูุจ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุดุฑูุงุช ุงูุดุญู

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ุชุดุบูู init:shipping
cd backend
npm run init:shipping

# ุชุญูู ูู ุชูุนูู ุงูุดุฑูุงุช
# ุงูุชุญ: http://localhost:3000/admin/settings/shipping
```

### ุงููุดููุฉ: ุงูุถุฑูุจุฉ ูุง ุชุญุณุจ

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ุชุดุบูู init:settings
cd backend
npm run init:settings

# ุชุญูู ูู ุชูุนูู ุงูุถุฑูุจุฉ
# ุงูุชุญ: http://localhost:3000/admin/settings/general
```

### ุงููุดููุฉ: ุฃุณุนุงุฑ ุฎุงุทุฆุฉ

**ุงูุญู:**
1. ุงูุชุญ ููุญุฉ ุฅุฏุงุฑุฉ ุงูุดุญู
2. ุชุญูู ูู ุงูุฃุณุนุงุฑ ููู ูุฏููุฉ
3. ุนุฏูู ุงูุฃุณุนุงุฑ ุญุณุจ ุงูุญุงุฌุฉ

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ

#### StoreSettings
```prisma
model StoreSettings {
  id        String   @id
  key       String   @unique
  value     Json
  createdAt DateTime
  updatedAt DateTime
}
```

**ุงูุฅุนุฏุงุฏุงุช ุงููุชุงุญุฉ:**
- `tax_rate`: `{ rate: 0.15, enabled: true }`
- `free_shipping_threshold`: `{ amount: 500, enabled: true }`

#### ShippingProvider
```prisma
model ShippingProvider {
  id          String
  name        String   // "smsa", "redbox", "aramex"
  displayName String   // "ุณูุณุง", "ุฑูุฏุจูุณ", "ุฃุฑุงููุณ"
  enabled     Boolean
  apiKey      String?
  apiSecret   String?
  testMode    Boolean
  settings    Json?
}
```

#### ShippingRate
```prisma
model ShippingRate {
  id            String
  providerId    String
  city          String
  price         Float
  estimatedDays Int
}
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ููุชุทููุฑ:
1. โ ุดุบูู `ACTIVATE_SHIPPING.bat`
2. โ ุงูุชุญ ููุญุฉ ุงูุฅุฏุงุฑุฉ
3. โ ุงุฎุชุจุฑ ุงููุธุงู

### ููุฅูุชุงุฌ:
1. ๐ ุณุฌู ูู ุดุฑูุงุช ุงูุดุญู
2. ๐ ุงุญุตู ุนูู ููุงุชูุญ API
3. โ๏ธ ุฃุฏุฎู ุงูููุงุชูุญ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ
4. ๐ ุบููุฑ ุฅูู ุงููุถุน ุงูุญูููู
5. ๐ฐ ุนุฏูู ุงูุฃุณุนุงุฑ ุญุณุจ ุงูุญุงุฌุฉ
6. ๐ ุฑุงูุจ ุงูุทูุจุงุช

---

## ๐ ุงููููุงุช ุงููุฑุฌุนูุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `SHIPPING_SETUP_AR.md` | ุฏููู ุฅุนุฏุงุฏ ุงูุดุญู |
| `SHIPPING_SYSTEM_READY_AR.md` | ุชูุซูู ูุธุงู ุงูุดุญู |
| `START_SHIPPING.md` | ุฏููู ุงูุชุดุบูู ุงูุณุฑูุน |
| `INTEGRATE_SHIPPING_WITH_CHECKOUT.md` | ุฏููู ุงูุฑุจุท |

---

## โ ูุงุฆูุฉ ุงูุชุญูู

ูุจู ุงูุจุฏุก:
- [ ] MongoDB ูุนูู
- [ ] Backend ุนูู port 4000
- [ ] Frontend ุนูู port 3000
- [ ] ุชู ุชุดุบูู `ACTIVATE_SHIPPING.bat`
- [ ] ุชู ูุชุญ ููุญุฉ ุงูุฅุฏุงุฑุฉ
- [ ] ุชู ุชูุนูู ุงูุถุฑูุจุฉ
- [ ] ุชู ุชูุนูู ุดุฑูุฉ ุดุญู ูุงุญุฏุฉ ุนูู ุงูุฃูู
- [ ] ุชู ุงุฎุชุจุงุฑ ุทูุจ ูุงูู

---

## ๐ ุงููุธุงู ุฌุงูุฒ!

**ุงุจุฏุฃ ุงูุขู:**
```bash
ACTIVATE_SHIPPING.bat
```

ุซู ุงูุชุญ:
- ููุญุฉ ุงูุฅุฏุงุฑุฉ: http://localhost:3000/admin/settings/general
- ุตูุญุฉ ุงูุทูุจ: http://localhost:3000/checkout

---

**ุชู ุจูุงุก ูุธุงู ุทูุจุงุช ูุชูุงูู ูุน:**
- โ ูุนูููุงุช ุดุญู ูุงููุฉ
- โ ุงุฎุชูุงุฑ ุดุฑูุฉ ุงูุดุญู
- โ ุญุณุงุจ ุชููุงุฆู ููุถุฑูุจุฉ
- โ ุญุณุงุจ ุชููุงุฆู ููุดุญู
- โ ุดุญู ูุฌุงูู ููุทูุจุงุช ุงููุจูุฑุฉ
- โ ุฅุนุฏุงุฏุงุช ูุฑูุฉ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ

**ุฌุงูุฒ ููุงูุทูุงู! ๐**
